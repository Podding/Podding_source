ruby:
  # deal with optional locals and sane defaults

  unless locals.has_key?( :list_icon ) # default to list icon
    list_icon = "list"
  end

  unless locals.has_key?( :list_label ) && locals.has_key?( :list_icon )
    if locals.has_key?( :list_status ) # set icons for the three known statuses as well as set a default status
      if list_status == "planned"
        list_icon = "calendar"
        list_label = "Geplante Folgen"
        id = "planned_episodes"
      elsif list_status == "live"
        list_icon = "bullhorn"
        list_label = "Live gestreamte Folgen"
        id = "live_episodes"
      elsif list_status == "published"
        list_icon = "archive"
        list_label = "VerÃ¶ffentlichte Folgen"
        id = "published_episodes"
      end
    else 
      list_status = "nostatus"
    end
  end

  unless locals.has_key?( :display_list_label )
    display_list_label = true
  end

- if mode == "mini-date"
  section class=["episodeListMini-wrapper","episodeList"]
    - if locals.has_key?( :list_label ) && display_list_label
      h3.episodeListMini-heading
        i.episodeListMini-heading-icon class="icon-#{ list_icon }"
        span.episodeListMini-heading-text #{ list_label }
    ul.episodeListMini
      - for episode in episodes
        == slim :"includes/_episode", :locals => { :episode => episode, :mode => "mini-date" }

        - if locals.has_key?( :more_link ) # you can pass an optional more-link to this partial
         li.episodeListMini-moreLink 
          a.basicLink href="#{ more_link }"
            |  mehr... <i class="icon-circle-arrow-right"></i>

- elsif mode == "archive"
  section class=["episodeListArchive","episodeList"]
    - if locals.has_key?( :list_label ) && display_list_label
      h3.episodeListArchive-heading #{ list_label }

    - for episode in episodes
      == slim :"includes/_episode", :locals => { :episode => episode, :mode => "archive" }

- elsif mode == "short"
  section class=["episodeListShort","episodeList"]
    - if locals.has_key?( :list_label ) && display_list_label
      h3.episodeListShort-heading
        i.episodeListShort-heading-icon class="icon-#{ list_icon }"
        span.episodeListShort-heading-text #{ list_label }

    - for episode in episodes
      == slim :"includes/_episode", :locals => { :episode => episode, :mode => "short" }
